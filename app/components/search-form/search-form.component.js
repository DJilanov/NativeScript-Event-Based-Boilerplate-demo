"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var page_1 = require("ui/page");
var backend_service_1 = require("../../core/backend/backend.service");
var event_bus_service_1 = require("../../core/event-bus/event-bus.service");
var pitch_service_1 = require("../../services/pitch/pitch.service");
var dateRange = {
    minDate: new Date(1975, 0, 29),
    maxDate: new Date(2045, 0, 29)
};
var SearchFormComponent = (function () {
    function SearchFormComponent(page, pitchService, backendService, eventBusService) {
        this.page = page;
        this.pitchService = pitchService;
        this.backendService = backendService;
        this.eventBusService = eventBusService;
        this.pitchId = 32990;
        this.startDate = new Date();
        this.endDate = new Date();
        this.startDateButtonVisible = false;
        this.startDatePickerVisible = false;
        this.endDateButtonVisible = false;
        this.endDatePickerVisible = false;
    }
    SearchFormComponent.prototype.showStartDatePicker = function () {
        var textFieldStartDate = this.page.getViewById("startDateTextField");
        this.startDateButtonVisible = true;
        this.startDatePickerVisible = true;
        setTimeout(function () {
            textFieldStartDate.dismissSoftInput();
        }, 100);
    };
    SearchFormComponent.prototype.showEndDatePicker = function () {
        var textFieldEndDate = this.page.getViewById("endDateTextField");
        this.endDateButtonVisible = true;
        this.endDatePickerVisible = true;
        setTimeout(function () {
            textFieldEndDate.dismissSoftInput();
        }, 100);
    };
    SearchFormComponent.prototype.enterStartDate = function () {
        var datePicker = this.page.getViewById("startDatePicker");
        var selectedDate = new Date(datePicker.year, datePicker.month - 1, datePicker.day);
        this.startDate = selectedDate;
        this.startDateButtonVisible = false;
        this.startDatePickerVisible = false;
    };
    SearchFormComponent.prototype.enterEndDate = function () {
        var datePicker = this.page.getViewById("endDatePicker");
        var selectedDate = new Date(datePicker.year, datePicker.month - 1, datePicker.day);
        this.endDate = selectedDate;
        this.endDateButtonVisible = false;
        this.endDatePickerVisible = false;
    };
    SearchFormComponent.prototype.onDatePickerLoaded = function (args) {
        var datePicker = args.object;
        datePicker.minDate = dateRange.minDate;
        datePicker.maxDate = dateRange.maxDate;
    };
    SearchFormComponent.prototype.onSeachTap = function (event) {
        var _this = this;
        var idInput = this.page.getViewById("pitchId");
        idInput.dismissSoftInput();
        this.backendService.fetchPitches({
            id: idInput.text,
            startDate: this.startDate.toISOString().split('T')[0],
            endDate: this.endDate.toISOString().split('T')[0],
        }).then(function (response) {
            return response.json();
        }).then(function (jsonData) {
            _this.pitchService.setPitches(jsonData.data);
            _this.eventBusService.emitFetchedPitchData(jsonData.data);
        });
    };
    SearchFormComponent = __decorate([
        core_1.Component({
            selector: "ns-search-form",
            moduleId: module.id,
            templateUrl: "./search-form.component.html",
            styleUrls: ['./search-form.component.css']
        }),
        __metadata("design:paramtypes", [page_1.Page,
            pitch_service_1.PitchService,
            backend_service_1.BackendService,
            event_bus_service_1.EventBusService])
    ], SearchFormComponent);
    return SearchFormComponent;
}());
exports.SearchFormComponent = SearchFormComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLWZvcm0uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic2VhcmNoLWZvcm0uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTBDO0FBSTFDLGdDQUErQjtBQUUvQixzRUFBb0U7QUFDcEUsNEVBQXlFO0FBRXpFLG9FQUFrRTtBQUVsRSxJQUFNLFNBQVMsR0FBRztJQUNkLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztJQUM5QixPQUFPLEVBQUUsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Q0FDakMsQ0FBQztBQVNGO0lBV0ksNkJBQ1ksSUFBVSxFQUNWLFlBQTBCLEVBQzFCLGNBQThCLEVBQzlCLGVBQWdDO1FBSGhDLFNBQUksR0FBSixJQUFJLENBQU07UUFDVixpQkFBWSxHQUFaLFlBQVksQ0FBYztRQUMxQixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBYjVDLFlBQU8sR0FBVyxLQUFLLENBQUM7UUFDeEIsY0FBUyxHQUFTLElBQUksSUFBSSxFQUFFLENBQUM7UUFDN0IsWUFBTyxHQUFTLElBQUksSUFBSSxFQUFFLENBQUM7UUFFM0IsMkJBQXNCLEdBQVksS0FBSyxDQUFDO1FBQ3hDLDJCQUFzQixHQUFZLEtBQUssQ0FBQztRQUN4Qyx5QkFBb0IsR0FBWSxLQUFLLENBQUE7UUFDckMseUJBQW9CLEdBQVksS0FBSyxDQUFBO0lBU3JDLENBQUM7SUFFRCxpREFBbUIsR0FBbkI7UUFDSSxJQUFJLGtCQUFrQixHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFZLG9CQUFvQixDQUFDLENBQUM7UUFDaEYsSUFBSSxDQUFDLHNCQUFzQixHQUFHLElBQUksQ0FBQztRQUNuQyxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxDQUFDO1FBRW5DLFVB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O1FBUC9CLGdCQUFTLENBQUM7WUFDUCxRQUFRLEVBQUUsZ0JBQWdCO1lBQzFCLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRTtZQUNuQixXQUFXLEVBQUUsOEJBQThCO1lBQzNDLFNBQVMsRUFBRSxDQUFFLDZCQUE2QixDQUFFO1NBQy9DLENBQUM7eUNBY29CLFdBQUk7WUFDSSw0QkFBWTtZQUNWLGdDQUFjO1lBQ2IsbUNBQWU7T0FmbkMsbUJBQW1CLENBNkUvQjtJQUFELDBCQUFDO0NBQUEsQUE3RUQsSUE2RUM7QUE3RVksa0RBQW1CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IFJvdXRlckV4dGVuc2lvbnMgfSBmcm9tIFwibmF0aXZlc2NyaXB0LWFuZ3VsYXIvcm91dGVyXCI7XG5pbXBvcnQgeyBEYXRlUGlja2VyIH0gZnJvbSBcInVpL2RhdGUtcGlja2VyXCI7XG5pbXBvcnQgeyBUZXh0RmllbGQgfSBmcm9tIFwidWkvdGV4dC1maWVsZFwiO1xuaW1wb3J0IHsgUGFnZSB9IGZyb20gXCJ1aS9wYWdlXCI7XG5cbmltcG9ydCB7IEJhY2tlbmRTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL2NvcmUvYmFja2VuZC9iYWNrZW5kLnNlcnZpY2VcIjtcbmltcG9ydCB7IEV2ZW50QnVzU2VydmljZSB9IGZyb20gXCIuLi8uLi9jb3JlL2V2ZW50LWJ1cy9ldmVudC1idXMuc2VydmljZVwiO1xuXG5pbXBvcnQgeyBQaXRjaFNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvcGl0Y2gvcGl0Y2guc2VydmljZVwiO1xuXG5jb25zdCBkYXRlUmFuZ2UgPSB7XG4gICAgbWluRGF0ZTogbmV3IERhdGUoMTk3NSwgMCwgMjkpLFxuICAgIG1heERhdGU6IG5ldyBEYXRlKDIwNDUsIDAsIDI5KVxufTtcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6IFwibnMtc2VhcmNoLWZvcm1cIixcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHRlbXBsYXRlVXJsOiBcIi4vc2VhcmNoLWZvcm0uY29tcG9uZW50Lmh0bWxcIixcbiAgICBzdHlsZVVybHM6IFsgJy4vc2VhcmNoLWZvcm0uY29tcG9uZW50LmNzcycgXVxufSlcblxuZXhwb3J0IGNsYXNzIFNlYXJjaEZvcm1Db21wb25lbnQge1xuXG4gICAgcGl0Y2hJZDogbnVtYmVyID0gMzI5OTA7XG4gICAgc3RhcnREYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcbiAgICBlbmREYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcblxuICAgIHN0YXJ0RGF0ZUJ1dHRvblZpc2libGU6IEJvb2xlYW4gPSBmYWxzZTtcbiAgICBzdGFydERhdGVQaWNrZXJWaXNpYmxlOiBCb29sZWFuID0gZmFsc2U7XG4gICAgZW5kRGF0ZUJ1dHRvblZpc2libGU6IEJvb2xlYW4gPSBmYWxzZVxuICAgIGVuZERhdGVQaWNrZXJWaXNpYmxlOiBCb29sZWFuID0gZmFsc2VcbiAgICBcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwYWdlOiBQYWdlLFxuICAgICAgICBwcml2YXRlIHBpdGNoU2VydmljZTogUGl0Y2hTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIGJhY2tlbmRTZXJ2aWNlOiBCYWNrZW5kU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBldmVudEJ1c1NlcnZpY2U6IEV2ZW50QnVzU2VydmljZVxuICAgICkge1xuXG4gICAgfVxuICAgIFxuICAgIHNob3dTdGFydERhdGVQaWNrZXIoKTogdm9pZCB7XG4gICAgICAgIGxldCB0ZXh0RmllbGRTdGFydERhdGUgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8VGV4dEZpZWxkPihcInN0YXJ0RGF0ZVRleHRGaWVsZFwiKTtcbiAgICAgICAgdGhpcy5zdGFydERhdGVCdXR0b25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdGFydERhdGVQaWNrZXJWaXNpYmxlID0gdHJ1ZTtcblxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGV4dEZpZWxkU3RhcnREYXRlLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9XG4gICAgXG4gICAgc2hvd0VuZERhdGVQaWNrZXIoKTogdm9pZCB7XG4gICAgICAgIGxldCB0ZXh0RmllbGRFbmREYXRlID0gdGhpcy5wYWdlLmdldFZpZXdCeUlkPFRleHRGaWVsZD4oXCJlbmREYXRlVGV4dEZpZWxkXCIpO1xuICAgICAgICB0aGlzLmVuZERhdGVCdXR0b25WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbmREYXRlUGlja2VyVmlzaWJsZSA9IHRydWU7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRleHRGaWVsZEVuZERhdGUuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICB9LCAxMDApO1xuICAgIH1cbiAgICBcbiAgICBlbnRlclN0YXJ0RGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgbGV0IGRhdGVQaWNrZXIgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8RGF0ZVBpY2tlcj4oXCJzdGFydERhdGVQaWNrZXJcIik7XG4gICAgICAgIGxldCBzZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkYXRlUGlja2VyLnllYXIsIGRhdGVQaWNrZXIubW9udGggLSAxLCBkYXRlUGlja2VyLmRheSk7XG4gICAgICAgIHRoaXMuc3RhcnREYXRlID0gc2VsZWN0ZWREYXRlO1xuICAgICAgICB0aGlzLnN0YXJ0RGF0ZUJ1dHRvblZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdGFydERhdGVQaWNrZXJWaXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgZW50ZXJFbmREYXRlKCk6IHZvaWQge1xuICAgICAgICBsZXQgZGF0ZVBpY2tlciA9IHRoaXMucGFnZS5nZXRWaWV3QnlJZDxEYXRlUGlja2VyPihcImVuZERhdGVQaWNrZXJcIik7XG4gICAgICAgIGxldCBzZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkYXRlUGlja2VyLnllYXIsIGRhdGVQaWNrZXIubW9udGggLSAxLCBkYXRlUGlja2VyLmRheSk7XG4gICAgICAgIHRoaXMuZW5kRGF0ZSA9IHNlbGVjdGVkRGF0ZTtcbiAgICAgICAgdGhpcy5lbmREYXRlQnV0dG9uVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVuZERhdGVQaWNrZXJWaXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgb25EYXRlUGlja2VyTG9hZGVkKGFyZ3MpOiB2b2lkIHtcbiAgICAgICAgbGV0IGRhdGVQaWNrZXIgPSA8RGF0ZVBpY2tlcj5hcmdzLm9iamVjdDtcbiAgICAgICAgZGF0ZVBpY2tlci5taW5EYXRlID0gZGF0ZVJhbmdlLm1pbkRhdGU7XG4gICAgICAgIGRhdGVQaWNrZXIubWF4RGF0ZSA9IGRhdGVSYW5nZS5tYXhEYXRlO1xuICAgIH1cblxuICAgIG9uU2VhY2hUYXAoZXZlbnQpOiB2b2lkIHtcbiAgICAgICAgbGV0IGlkSW5wdXQgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8VGV4dEZpZWxkPihcInBpdGNoSWRcIik7XG4gICAgICAgIGlkSW5wdXQuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICB0aGlzLmJhY2tlbmRTZXJ2aWNlLmZldGNoUGl0Y2hlcyh7XG4gICAgICAgICAgICBpZDogaWRJbnB1dC50ZXh0LFxuICAgICAgICAgICAgc3RhcnREYXRlOiB0aGlzLnN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgICAgICAgICBlbmREYXRlOiB0aGlzLmVuZERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsgXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOyBcbiAgICAgICAgfSkudGhlbigoanNvbkRhdGEpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGl0Y2hTZXJ2aWNlLnNldFBpdGNoZXMoanNvbkRhdGEuZGF0YSlcbiAgICAgICAgICAgIHRoaXMuZXZlbnRCdXNTZXJ2aWNlLmVtaXRGZXRjaGVkUGl0Y2hEYXRhKGpzb25EYXRhLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG59Il19